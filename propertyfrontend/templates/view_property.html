{% extends "propertyfrontend_base.html" %}

{% block page_title %}Property details for {{ title.title_number }} - GOV.UK{% endblock %}

{% block content %}

<main id="wrapper" role="main">
  <div id="content">

    {% include "inc_alpha_banner.html" %}

    <div id="global-breadcrumb">
        <ol role="breadcrumbs">
            <li><a href="https://www.gov.uk">Home</a></li>
            <li><a href="/">Property and land</a></li>
        </ol>
    </div>

    <div class="outer-block">
        <div class="inner-block">
            <h1 class="heading-prefix">Property details</h1>
        </div>
    </div>

    <div class="grid-wrapper">

        <div class="grid grid-1-2">
            <div class="inner-block">

                {% if address %}
                  {% if address.structured %}
                    <h2 class="collapse-top" itemscope itemtype="http://schema.org/PostalAddress">
                      <span itemprop="streetAddress">
                        {{ address.structured.house_no }} {{ address.structured.street_name }}<br>
                      </span>
                      <span itemprop="addressLocality">{{ address.structured.town }}</span><br>
                      <span itemprop="addressRegion">
                          {% if address.structured.postal_county %}
                              {{ address.structured.postal_county }}<br>
                          {% endif %}
                          {% if address.structured.region_name %}
                              {{ address.structured.region_name }}<br>
                          {% endif %}
                      </span>
                      <span itemprop="postalCode">{{ address.structured.postcode }}<br></span>
                      {% if address.structured.country %}
                        <span itemprop="addressCountry">{{ address.structured.country }}</span>
                      {% endif %}
                    </h2>
                  {% else %}
                    <h2 class="collapse-top">
                    {% for item in address.string.get_fields()  %}
                        {{ item }}<br>
                    {% endfor %}
                    </h2>
                  {% endif %}
                {% else %}
                  <h2 class="collapse-top">{{ title.property_description.fields['addresses'][0].full_address }}</h2>
                {% endif %}

                <dl class="definition-tabular--1-3--b">

                    <dt>Title number</dt>
                    <dd>{{ title.title_number }}</dd>

                    <dt>Title quality</dt>
                    <dd>{{ title.class_of_title | capitalize }}</dd>

                    <dt>Tenure type</dt>
                    <dd>{{ title.tenure | capitalize }}</dd>

                    {% if title.price_paid %}
                    <dt>Price paid</dt>
                      {% if title.price_paid.fields.amount %}
                        <dd>{{ title.price_paid.fields.amount[0] }} on {{ title.price_paid.fields.date[0] }}</dd>
                      {% else %}
                        <dd>{{ title.price_paid.full_text.decode('unicode-escape') | striptags  }}</dd>
                      {% endif %}
                    {% endif %}

                </dl>

            </div>
        </div>

        <div class="grid grid-1-2">
            <div class="inner-block">
                <div id="map" style="width: 100%; height: 300px"></div>
            </div>
        </div>

    </div>

    <div class="grid-wrapper">

      <div class="grid grid-1-2">
        <div class="inner-block">

          <p><a href="{{service_frontend_url}}/{{title.title_number}}">View official title register for this property</a></p>

          <details class="font-xsmall">
            <summary>What is the official title register?</summary>
            <div class="text panel-indent">
              <p>You can get information about registered property or land in England and Wales, even if you donâ€™t own it.</p>
              <p>You will need to sign in using GOV.UK Verify to view official title registers.</p>
            </div>
          </details>

        </div>
      </div>

      <div class="grid grid-1-2">
        <div class="inner-block">

          <p>
            <a href="#">Download vCard</a><br>
            <a href="#">Register for property notifications</a>
          </p>

        </div>
      </div>

    </div>

  </div><!-- end content -->
</main>

{% endblock %}

{% block js_additionals %}
    <script type='text/javascript'>
        var extentData = {{ title.extent | tojson}};
        var apiKey = "{{ apiKey }}";
    </script>
    <script src="{{asset_path}}/javascripts/map.js"></script>
{% endblock %}
